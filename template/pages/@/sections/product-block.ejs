<div id="product-block" class="product-block my-4 mb-lg-5">
  <div class="container">
    <section id="product" class="product" data-to-render="true">
      <!--
        `TheProduct` should be rendered (hydrated) here:
        https://developers.e-com.plus/storefront/@ecomplus/storefront-components/docs/TheProduct.html
      -->

      <div class="row">
        <div class="col-12 col-md-6 mb-4">
          <!-- Picture(s) gallery will be inserted dynamically within `TheProduct` -->
          <% if (_.state.pictures) { %>
            <% const imgObj = _.ecomUtils.img(_.state, null, 'big') %>
            <% if (imgObj) { %>
              <div data-slot="first-picture">
                <picture class="product__picture">
                  <source
                    srcset="<%= _.ecomUtils.img(_.state).url %>"
                    type="image/webp"
                    media="(max-width: 399.98px)"
                  >
                  <source
                    srcset="<%= imgObj.url %>"
                    type="image/webp"
                    media="(min-width: 400px)"
                  >
                  <img
                    src="<%= imgObj.url.replace(/\.webp$/, '') %>"
                    alt="<%= imgObj.alt %>"
                  >
                </picture>
              </div>
            <% } %>
          <% } %>

          <div data-slot="gallery-footer">
            <!-- Custom additional code on bottom of images gallery -->
          </div>
        </div>

        <div class="col">
          <div data-slot="heading">
            <h1 class="product__name">
              <%= _.ecomUtils.name(_.state) %>
            </h1>
            <p class="product__sku">
              COD: <%= _.state.sku %>
            </p>
          </div>

          <% if (_.state.available && _.state.visible && _.ecomUtils.inStock(_.state)) { %>
            <div class="product__price prices prices--big">
              <strong class="prices__value">
                <%= _.ecomUtils.formatMoney(_.ecomUtils.price(_.state)) %>
              </strong>
            </div>
          <% } %>

          <% if (_.state.variations && _.state.variations.length) { %>
            <div data-slot="variations-info">
              <a href="javascript:;" data-toggle="modal" data-target="#modal-center-1" style="padding: 7px; border: 1px solid #ccc; font-size:18px">
                Guia de tamanho
              </a>
              <div class="modal modal-center fade" id="modal-center-1" tabindex="-1" style="display: none;" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header" style="display: flex;align-items: center; justify-content: space-between">
                      <h3 class="modal-title">Tabela de Medidas</h3>
                      <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">x</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <table cellspacing="0" cellpadding="2" bordercolor="666633" border="1"> <tbody><tr><td><h4 style="text-align: center; line-height: 1;"><span style="font-weight: bold;">&nbsp; CAMISA SOCIAL INFANTIL&nbsp;&nbsp;</span></h4></td><td><h4 style="text-align: center; line-height: 1;"><span style="font-weight: bold;">&nbsp; BERMUDA SOCIAL&nbsp;</span></h4></td></tr><tr><td><p></p><h5 style="text-align: left; line-height: 1;"><span style="font-weight: bold;">Camisa social 01 ano</span></h5>&nbsp;= Torax 30 cm<p></p><p>&nbsp;= Compr. 35 cm</p></td><td><h5 style="line-height: 1;"><span style="font-weight: bold;">Bermuda Social 1 ano:</span></h5>&nbsp;= cintura 26 cm<br>&nbsp;= quadril 29 cm&nbsp;<br>&nbsp;= compr. 28 cm&nbsp;</td></tr><tr><td><p></p><h5 style="line-height: 1;"><span style="font-weight: bold;">Camisa social&nbsp; 02 anos</span></h5>&nbsp;= Torax 31 cm<p></p><p>&nbsp;= Compr. 38 cm</p></td><td><h5 style="line-height: 1;"><span style="font-weight: bold;">Bermuda Social 2 anos:</span></h5>&nbsp;= cintura 27 cm&nbsp;<br> = quadril 30 cm<br> = compr. 29 cm&nbsp;</td></tr><tr><td><p></p><h5 style="line-height: 1;"><span style="font-weight: bold;">Camisa social&nbsp; 03 anos</span></h5>&nbsp;= Torax 34 cm<p></p><p>&nbsp;= Compr. 41 cm</p></td><td><h5 style="line-height: 1;"><span style="font-weight: bold;">Bermuda Social 3 anos:</span></h5>&nbsp;= cintura 28 cm<br>&nbsp; = quadril 31 cm<br>&nbsp; = compr. 29 cm</td></tr></tbody></table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          <% } %>

          <div class="spinner-border m-4" role="status">
            <span class="sr-only">Loading...</span>
          </div>

          <div class="product__buy">
            <button
              type="button"
              class="btn btn-lg btn-primary"
              onclick="ecomCart.addProduct(storefront.context.body)"
              <% if (_.state.variations && _.state.variations.length) { %>
                disabled
              <% } %>
            >
              <div data-slot="buy-button-content">
                <i class="fas fa-shopping-bag mr-1"></i>
                <%= _.dictionary('buy') %>
              </div>
            </button>
          </div>

          <% if (_.state.short_description) { %>
            <div data-slot="short-description">
              <p class="product__info lead">
                <%= _.state.short_description %>
              </p>
            </div>
          <% } %>
        </div>
      </div>

      <%- await include('@/helpers/widgets-append', {
        _, opt: {}, field: 'productSlots'
      }) %>
    </section>

    <%- await include('@/helpers/widgets-append', {
      _, opt: {}, field: 'productBlockAppend'
    }) %>
  </div>
</div>

<%
const productJsonLd = {
  '@context': 'http://schema.org',
  '@type': 'Product',
  sku: _.state.sku,
  description: _.state.short_description || _.state.meta_description || _.ecomUtils.name(_.state),
  name: _.ecomUtils.name(_.state),
  offers: {
    '@type': 'Offer',
    url: `https://${_.settings.domain}/${_.state.slug}`,
    availability: `${(_.ecomUtils.inStock(_.state) ? 'In' : 'OutOf')}Stock`,
    priceCurrency: _.settings.currency,
    price: _.ecomUtils.price(_.state),
    itemCondition: `http://schema.org/${(_.state.condition === 'new' ? 'New' : 'Used')}Condition`,
    seller: {
      '@type': 'Organization',
      name: _.settings.name || _.store.name
    }
  }
}
if (_.state.brands && _.state.brands[0]) {
  productJsonLd.brand = {
    '@type': 'Brand',
    name: _.state.brands[0].name
  }
}
if (_.state.pictures && _.state.pictures.length) {
  productJsonLd.image = _.ecomUtils.img(_.state, null, 'zoom').url
}
if (_.state.mpn && _.state.mpn[0]) {
  productJsonLd.mpn = _.state.mpn[0]
}
%>
<script type="application/ld+json"><%-
  JSON.stringify(productJsonLd)
%></script>
